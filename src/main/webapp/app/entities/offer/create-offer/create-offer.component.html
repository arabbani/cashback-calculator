<div class="row justify-content-center">
    <div class="col-md-10">
        <div kendoDialogContainer></div>
        <tabset #createOfferTabs>
            <tab heading="Basic Info">
                <form name="basicInfoForm" role="form" #basicInfoForm="ngForm" novalidate>
                    <div class="form-group mb-3">
                        <label for="name">Name</label>
                        <h5 *ngIf="!editMode">{{ offer.name }}</h5>
                        <ng-container *ngIf="editMode">
                            <input type="text" class="form-control" id="name" name="name" [(ngModel)]="offer.name" #name="ngModel" maxlength="500" required
                                placeholder="Title" />
                            <ng-container *ngIf="name.dirty && name.invalid">
                                <span class="form-text text-danger" *ngIf="name?.errors.required">
                                    Name is required.
                                </span>
                                <span class="form-text text-danger" *ngIf="name?.errors.maxlength">
                                    This field cannot be longer than 500 characters.
                                </span>
                            </ng-container>
                        </ng-container>
                    </div>
                    <div class="form-group mb-3" *ngIf="editMode">
                        <label for="adminDescription">Admin Description</label>
                        <textarea autosize class="form-control" id="adminDescription" name="adminDescription" [(ngModel)]="offer.adminDescription"
                            #adminDescription="ngModel" maxlength="2000" required>
                        </textarea>
                        <ng-container *ngIf="adminDescription.dirty && adminDescription.invalid">
                            <span class="form-text text-danger" *ngIf="adminDescription?.errors.required">
                                Admin Description is required.
                            </span>
                            <span class="form-text text-danger" *ngIf="adminDescription?.errors.maxlength">
                                This field cannot be longer than 2000 characters.
                            </span>
                        </ng-container>
                    </div>
                    <div class="form-group mb-3">
                        <label for="description">Description</label>
                        <textarea autosize class="form-control" id="description" name="description" [(ngModel)]="offer.description" #description="ngModel"
                            maxlength="2000" required [readOnly]="!editMode">
                        </textarea>
                        <ng-container *ngIf="description.dirty && description.invalid">
                            <span class="form-text text-danger" *ngIf="description?.errors.required">
                                Description is required.
                            </span>
                            <span class="form-text text-danger" *ngIf="description?.errors.maxlength">
                                This field cannot be longer than 2000 characters.
                            </span>
                        </ng-container>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group mb-3 row">
                                <ng-container *ngIf="!editMode">
                                    <div class="col">
                                        <label class="mr-5">Start Date</label>
                                        {{ offer.startDate | date: 'medium' }}
                                    </div>
                                </ng-container>
                                <ng-container *ngIf="editMode">
                                    <div class="col-md-6">
                                        <label class="mr-5" for="startDate">Start Date</label>
                                        <input type="text" class="form-control" id="startDate" name="startDate" [(ngModel)]="offer.startDate" required placeholder="Start Date"
                                            bsDatepicker (bsValueChange)="onChangeStartDate($event)" />
                                    </div>
                                    <div class="col-md-6">
                                        <timepicker name="startTime" [(ngModel)]="offer.startDate" [showMeridian]="false"></timepicker>
                                    </div>
                                </ng-container>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group mb-3 row">
                                <ng-container *ngIf="!editMode">
                                    <div class="col">
                                        <label class="mr-5">End Date</label>
                                        {{ offer.endDate | date: 'medium' }}
                                    </div>
                                </ng-container>
                                <ng-container *ngIf="editMode">
                                    <div class="col-md-6">
                                        <label class="mr-5" for="endDate">End Date</label>
                                        <input *ngIf="editMode" type="text" class="form-control" id="endDate" name="endDate" [(ngModel)]="offer.endDate" required
                                            placeholder="End Date" bsDatepicker />
                                    </div>
                                    <div class="col-md-6" *ngIf="editMode">
                                        <timepicker name="endTime" [(ngModel)]="offer.endDate" [showMeridian]="false"></timepicker>
                                    </div>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="mb-3 col-md-6">
                            <label class="col-md-3 col-form-label" for="type">Type</label>
                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngIf="offer?.type && !editMode">
                                {{ offer.type.name }}
                            </span>
                            <ng-container *ngIf="editMode">
                                <div class="col-md-9">
                                    <ng-select *ngIf="editMode" id="type" name="type" [(ngModel)]="offer.type" [items]="offerTypes" bindLabel="name" placeholder="Offer Type"
                                        required appendTo="body" (change)="onOfferTypeChange($event)"></ng-select>
                                </div>
                            </ng-container>
                        </div>
                        <div class="col-md-6">
                            <div *ngIf="offer?.type && isCoupon" class="form-group mb-3 row">
                                <label class="col-md-3 col-form-label" for="code">Code</label>
                                <h6 *ngIf="!editMode">{{ offer.code }}</h6>
                                <ng-container *ngIf="editMode">
                                    <div class="col-md-9">
                                        <input type="text" class="form-control" id="code" name="code" [(ngModel)]="offer.code" #code="ngModel" maxlength="255" required
                                            placeholder="Code" />
                                    </div>
                                    <ng-container *ngIf="code.dirty && code.invalid">
                                        <span class="form-text text-danger" *ngIf="code?.errors.required">
                                            Code is required.
                                        </span>
                                        <span class="form-text text-danger" *ngIf="code?.errors.maxlength">
                                            This field cannot be longer than 255 characters.
                                        </span>
                                    </ng-container>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                    <div class="form-group mb-3">
                        <label class="mr-5" for="url">Url</label>
                        <a [href]="offer.url" target="_balnk">{{ offer.url }}</a>
                        <ng-container *ngIf="editMode">
                            <textarea autosize class="form-control" id="url" name="url" [(ngModel)]="offer.url" #url="ngModel" maxlength="2000">
                            </textarea>
                            <ng-container *ngIf="url.dirty && url.invalid">
                                <span class="form-text text-danger" *ngIf="url?.errors.maxlength">
                                    This field cannot be longer than 2000 characters.
                                </span>
                            </ng-container>
                        </ng-container>
                    </div>
                    <div class="text-center mt-2">
                        <button type="button" class="btn btn-success" [disabled]="basicInfoForm.form.invalid" (click)="goToNextTab(1)">Next</button>
                    </div>
                </form>
            </tab>
            <tab heading="Options">
                <form name="optionsForm" role="form" #optionsForm="ngForm" novalidate>
                    <div class="form-group mb-3" *ngIf="editMode">
                        <label for="adminDescription">Admin Description</label>
                        <textarea autosize class="form-control" id="adminDescription" name="adminDescription" [(ngModel)]="offer.adminDescription"
                            readonly></textarea>
                    </div>
                    <fieldset class="fieldset-fix mb-3">
                        <legend class="legend-fix">
                            <strong>Options</strong>
                        </legend>
                        <div class="row">
                            <div class="form-group col-md-4 mb-3">
                                <div class="row">
                                    <span class="col-md-6">
                                        <label for="active">Active</label>
                                    </span>
                                    <span class="col-md-6">
                                        <span *ngIf="!editMode" [ngClass]="{ 'badge': true, 'badge-pill': true, 'px-2': true, 'py-1': true, 'badge-success': offer.active, 'badge-danger': !offer.active }">{{ offer.active ? 'YES' : 'NO' }}</span>
                                        <kendo-switch *ngIf="editMode" id="active" name="active" [(ngModel)]="offer.active" onLabel="Y" offLabel="N"></kendo-switch>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-4 mb-3">
                                <div class="row">
                                    <span class="col-md-6">
                                        <label for="newUserOnly">New User Only</label>
                                    </span>
                                    <span class="col-md-6">
                                        <span *ngIf="!editMode" [ngClass]="{ 'badge': true, 'badge-pill': true, 'px-2': true, 'py-1': true, 'badge-success': offer.newUserOnly, 'badge-danger': !offer.newUserOnly }">{{ offer.newUserOnly ? 'YES' : 'NO' }}</span>
                                        <kendo-switch *ngIf="editMode" id="newUserOnly" name="newUserOnly" [(ngModel)]="offer.newUserOnly" onLabel="Y" offLabel="N"></kendo-switch>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-4 mb-3">
                                <div class="row">
                                    <span class="col-md-6">
                                        <label for="appOnly">App Only</label>
                                    </span>
                                    <span class="col-md-6">
                                        <span *ngIf="!editMode" [ngClass]="{ 'badge': true, 'badge-pill': true, 'px-2': true, 'py-1': true, 'badge-success': offer.appOnly, 'badge-danger': !offer.appOnly }">{{ offer.appOnly ? 'YES' : 'NO' }}</span>
                                        <kendo-switch *ngIf="editMode" id="appOnly" name="appOnly" [(ngModel)]="offer.appOnly" onLabel="Y" offLabel="N"></kendo-switch>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-4 mb-3">
                                <div class="row">
                                    <span class="col-md-6">
                                        <label for="websiteOnly">Website Only</label>
                                    </span>
                                    <span class="col-md-6">
                                        <span *ngIf="!editMode" [ngClass]="{ 'badge': true, 'badge-pill': true, 'px-2': true, 'py-1': true, 'badge-success': offer.websiteOnly, 'badge-danger': !offer.websiteOnly }">{{ offer.websiteOnly ? 'YES' : 'NO' }}</span>
                                        <kendo-switch *ngIf="editMode" id="websiteOnly" name="websiteOnly" [(ngModel)]="offer.websiteOnly" onLabel="Y" offLabel="N"></kendo-switch>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-4 mb-3">
                                <div class="row">
                                    <span class="col-md-6">
                                        <label for="dummy">Dummy</label>
                                    </span>
                                    <span class="col-md-6">
                                        <span *ngIf="!editMode" [ngClass]="{ 'badge': true, 'badge-pill': true, 'px-2': true, 'py-1': true, 'badge-success': offer.dummy, 'badge-danger': !offer.dummy }">{{ offer.dummy ? 'YES' : 'NO' }}</span>
                                        <kendo-switch *ngIf="editMode" id="dummy" name="dummy" [(ngModel)]="offer.dummy" onLabel="Y" offLabel="N"></kendo-switch>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-4 mb-3">
                                <div class="row">
                                    <span class="col-md-6">
                                        <label for="apsstrExclusive">Apsstr Exclusive</label>
                                    </span>
                                    <span class="col-md-6">
                                        <span *ngIf="!editMode" [ngClass]="{ 'badge': true, 'badge-pill': true, 'px-2': true, 'py-1': true, 'badge-success': offer.apsstrExclusive, 'badge-danger': !offer.apsstrExclusive }">{{ offer.apsstrExclusive ? 'YES' : 'NO' }}</span>
                                        <kendo-switch *ngIf="editMode" id="apsstrExclusive" name="apsstrExclusive" [(ngModel)]="offer.apsstrExclusive" onLabel="Y"
                                            offLabel="N"></kendo-switch>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="fieldset-fix mb-3">
                        <legend class="legend-fix">
                            <strong>Maximum Uses</strong>
                        </legend>
                        <div class="row">
                            <div class="form-group col-sm-3 col-lg-2 mb-3">
                                <label for="maximumUsesPerUser">Per User</label>
                                <input type="text" apsstrNumberInput class="form-control" id="maximumUsesPerUser" name="maximumUsesPerUser" [(ngModel)]="offer.maximumUsesPerUser"
                                    [readOnly]="!editMode" />
                            </div>
                            <div class="form-group col-sm-3 col-lg-2 mb-3">
                                <label for="maximumUsesPerDay">Per Day</label>
                                <input type="text" apsstrNumberInput class="form-control" id="maximumUsesPerDay" name="maximumUsesPerDay" [(ngModel)]="offer.maximumUsesPerDay"
                                    [readOnly]="!editMode" />
                            </div>
                            <div class="form-group col-sm-3 col-lg-2 mb-3">
                                <label for="maximumUsesPerWeek">Per Week</label>
                                <input type="text" apsstrNumberInput class="form-control" id="maximumUsesPerWeek" name="maximumUsesPerWeek" [(ngModel)]="offer.maximumUsesPerWeek"
                                    [readOnly]="!editMode" />
                            </div>
                            <div class="form-group col-sm-3 col-lg-2 mb-3">
                                <label for="maximumUsesPerMonth">Per Month</label>
                                <input type="text" apsstrNumberInput class="form-control" id="maximumUsesPerMonth" name="maximumUsesPerMonth" [(ngModel)]="offer.maximumUsesPerMonth"
                                    [readOnly]="!editMode" />
                            </div>
                            <div class="form-group col-sm-3 col-lg-2 mb-3">
                                <label for="maximumUsesPerNumber">Per Number</label>
                                <input type="text" apsstrNumberInput class="form-control" id="maximumUsesPerNumber" name="maximumUsesPerNumber" [(ngModel)]="offer.maximumUsesPerNumber"
                                    [readOnly]="!editMode" />
                            </div>
                        </div>
                    </fieldset>
                    <div class="text-center mt-2">
                        <button type="button" class="btn btn-primary mr-3" (click)="goToTab(0)">Previous</button>
                        <button type="button" class="btn btn-success" [disabled]="optionsForm.form.invalid" (click)="goToNextTab(2)">Next</button>
                    </div>
                </form>
            </tab>
            <tab heading="Detail Info" (select)="onSelectTab(2)">
                <form name="detailInfoForm" role="form" #detailInfoForm="ngForm" novalidate>
                    <div class="form-group mb-3" *ngIf="editMode">
                        <label for="adminDescription">Admin Description</label>
                        <textarea autosize class="form-control" id="adminDescription" name="adminDescription" [(ngModel)]="offer.adminDescription"
                            readonly></textarea>
                    </div>
                    <div class="row">
                        <div class="form-group mb-3 col-md-6">
                            <label class="mr-5" for="affiliate">Affiliate</label>
                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngIf="offer?.affiliate && !editMode">
                                {{ offer.affiliate.name }}
                            </span>
                            <ng-select *ngIf="editMode" id="affiliate" name="affiliate" [(ngModel)]="offer.affiliate" [items]="affiliates" bindLabel="name"
                                placeholder="Affiliate" appendTo="body" required></ng-select>
                        </div>
                        <div class="form-group mb-3 col-md-6">
                            <label class="mr-5" for="merchant">Merchant</label>
                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngIf="offer?.merchant && !editMode">
                                {{ offer.merchant.name }}
                            </span>
                            <ng-select *ngIf="editMode" id="merchant" name="merchant" [(ngModel)]="offer.merchant" [items]="merchants" bindLabel="name"
                                placeholder="Merchant" appendTo="body" required></ng-select>
                        </div>
                    </div>
                    <div class="form-group mb-3">
                        <label class="mr-5" for="categories">Categories</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let category of offerCategories">
                            {{ category.name }}
                        </span>
                        <ng-select *ngIf="editMode" id="categories" name="categories" [(ngModel)]="offerCategories" [items]="categories" bindLabel="name"
                            [multiple]="true" [closeOnSelect]="false" placeholder="Categories" appendTo="body" (change)="onCategoryChange($event)">
                            <ng-template ng-header-tmp>
                                <div class="my-2 ml-5">
                                    <button (click)="selectAllCategories()" class="btn btn-sm btn-secondary">Select all</button>
                                    <button (click)="unselectAllCategories()" class="btn btn-sm btn-danger">Unselect all</button>
                                </div>
                            </ng-template>
                        </ng-select>
                    </div>
                    <div class="form-group mb-3">
                        <label class="mr-5" for="subCategories">Sub Categories</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let subCategory of offer.subCategories">
                            {{ subCategory.code }}
                        </span>
                        <ng-select *ngIf="editMode" id="subCategories" name="subCategories" [(ngModel)]="offer.subCategories" [items]="filteredSubCategories"
                            bindLabel="code" [multiple]="true" [closeOnSelect]="false" placeholder="Sub Categories" appendTo="body"
                            (change)="onSubCategoryChange($event)" required>
                            <ng-template ng-header-tmp>
                                <div class="my-2 ml-5">
                                    <button (click)="selectAllSubCategories()" class="btn btn-sm btn-secondary">Select all</button>
                                    <button (click)="unselectAllSubCategories()" class="btn btn-sm btn-danger">Unselect all</button>
                                </div>
                            </ng-template>
                        </ng-select>
                    </div>
                    <div class="form-group mb-3">
                        <label class="mr-5" for="serviceProviders">Service Providers</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let serviceProvider of offer.serviceProviders">
                            {{ serviceProvider.name }}
                        </span>
                        <ng-select *ngIf="editMode" id="serviceProviders" name="serviceProviders" [(ngModel)]="offer.serviceProviders" [items]="filteredServiceProviders"
                            bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Service Providers" appendTo="body">
                            <ng-template ng-header-tmp>
                                <div class="my-2 ml-5">
                                    <button (click)="selectAllServiceProviders()" class="btn btn-sm btn-secondary">Select all</button>
                                    <button (click)="unselectAllServiceProviders()" class="btn btn-sm btn-danger">Unselect all</button>
                                </div>
                            </ng-template>
                        </ng-select>
                    </div>
                    <fieldset class="fieldset-fix mb-3" *ngIf="isRechargeExtra">
                        <legend class="legend-fix">
                            <strong>Recharge Info</strong>
                        </legend>
                        <div class="form-group mb-3" *ngIf="editMode || offer?.rechargeInfo?.circles?.length > 0">
                            <label class="mr-5" for="recharge_info_circles">Circles</label>
                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let circle of offer.rechargeInfo.circles">
                                {{ circle.name }}
                            </span>
                            <ng-select *ngIf="editMode" id="recharge_info_circles" name="recharge_info_circles" [(ngModel)]="offer.rechargeInfo.circles"
                                [items]="circles" bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Circles"
                                appendTo="body">
                                <ng-template ng-header-tmp>
                                    <div class="my-2 ml-5">
                                        <button (click)="selectAllCircles()" class="btn btn-sm btn-secondary">Select all</button>
                                        <button (click)="unselectAllCircles()" class="btn btn-sm btn-danger">Unselect all</button>
                                    </div>
                                </ng-template>
                            </ng-select>
                        </div>
                        <div class="form-group mb-3">
                            <label class="mr-5" for="recharge_info_recharge_types">Recharge Types</label>
                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let rechargePlanType of offer?.rechargeInfo?.rechargePlanTypes">
                                {{ rechargePlanType.name }}
                            </span>
                            <ng-select *ngIf="editMode" id="recharge_info_recharge_types" name="recharge_info_recharge_types" [(ngModel)]="offer.rechargeInfo.rechargePlanTypes"
                                [items]="rechargePlanTypes" bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Recharge Types"
                                appendTo="body" required>
                                <ng-template ng-header-tmp>
                                    <div class="my-2 ml-5">
                                        <button (click)="selectAllRechargeTypes()" class="btn btn-sm btn-secondary">Select all</button>
                                        <button (click)="unselectAllRechargeTypes()" class="btn btn-sm btn-danger">Unselect all</button>
                                    </div>
                                </ng-template>
                            </ng-select>
                        </div>
                    </fieldset>
                    <fieldset class="fieldset-fix mb-3" *ngIf="(isBus || isFlight) && offer.travelInfo">
                        <legend class="legend-fix">
                            <strong>Travel Info</strong>
                        </legend>
                        <div class="form-group mb-3">
                            <label class="mr-5" for="travel_info_types">Travel Types</label>
                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let travelType of offer.travelInfo.types">
                                {{ travelType.name }}
                            </span>
                            <ng-select *ngIf="editMode" id="travel_info_types" name="travel_info_types" [(ngModel)]="offer.travelInfo.types" [items]="travelTypes"
                                bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Travel Types" appendTo="body"
                                [required]="isFlight">
                                <ng-template ng-header-tmp>
                                    <div class="my-2 ml-5">
                                        <button (click)="selectAllTravelTypes()" class="btn btn-sm btn-secondary">Select all</button>
                                        <button (click)="unselectAllTravelTypes()" class="btn btn-sm btn-danger">Unselect all</button>
                                    </div>
                                </ng-template>
                            </ng-select>
                        </div>
                        <ng-container *ngIf="isFlight">
                            <fieldset class="fieldset-fix mx-3">
                                <legend class="legend-fix">
                                    <strong>Flight Info</strong>
                                </legend>
                                <div class="form-group mb-3">
                                    <label class="mr-5" for="flight_info_types">Types</label>
                                    <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let flightType of offer.travelInfo.flightInfo.types">
                                        {{ flightType.name }}
                                    </span>
                                    <ng-select *ngIf="editMode" id="flight_info_types" name="flight_info_types" [(ngModel)]="offer.travelInfo.flightInfo.types"
                                        [items]="regions" bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Flight Types"
                                        appendTo="body" required>
                                        <ng-template ng-header-tmp>
                                            <div class="my-2 ml-5">
                                                <button (click)="selectAllFlightTypes()" class="btn btn-sm btn-secondary">Select all</button>
                                                <button (click)="unselectAllFlightTypes()" class="btn btn-sm btn-danger">Unselect all</button>
                                            </div>
                                        </ng-template>
                                    </ng-select>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="mr-5" for="flight_info_origins">Origins</label>
                                    <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let origin of offer.travelInfo.flightInfo.origins">
                                        {{ origin.name }}
                                    </span>
                                    <ng-select *ngIf="editMode" id="flight_info_origins" name="flight_info_origins" [(ngModel)]="offer.travelInfo.flightInfo.origins"
                                        [items]="regions" bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Origins"
                                        appendTo="body" required>
                                        <ng-template ng-header-tmp>
                                            <div class="my-2 ml-5">
                                                <button (click)="selectAllFlightOrigins()" class="btn btn-sm btn-secondary">Select all</button>
                                                <button (click)="unselectAllFlightOrigins()" class="btn btn-sm btn-danger">Unselect all</button>
                                            </div>
                                        </ng-template>
                                    </ng-select>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="mr-5" for="flight_info_class">Travel Classes</label>
                                    <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let travelClass of offer.travelInfo.flightInfo.travelClasses">
                                        {{ travelClass.name }}
                                    </span>
                                    <ng-select *ngIf="editMode" id="flight_info_class" name="flight_info_class" [(ngModel)]="offer.travelInfo.flightInfo.travelClasses"
                                        [items]="flightClasses" bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Travel Classes"
                                        appendTo="body" required>
                                        <ng-template ng-header-tmp>
                                            <div class="my-2 ml-5">
                                                <button (click)="selectAllFlightClasses()" class="btn btn-sm btn-secondary">Select all</button>
                                                <button (click)="unselectAllFlightClasses()" class="btn btn-sm btn-danger">Unselect all</button>
                                            </div>
                                        </ng-template>
                                    </ng-select>
                                </div>
                            </fieldset>
                        </ng-container>
                        <ng-container *ngIf="isBus">
                            <fieldset class="fieldset-fix mx-3">
                                <legend class="legend-fix">
                                    <strong>Bus Info</strong>
                                </legend>
                                <div class="form-group mb-3">
                                    <label class="mr-5" for="fromCity">From</label>
                                    <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let fromCity of offer.travelInfo.busInfo.froms">
                                        {{ fromCity.name }}
                                    </span>
                                    <ng-select *ngIf="editMode" id="fromCity" name="fromCity" [(ngModel)]="offer.travelInfo.busInfo.froms" [items]="cities" bindLabel="name"
                                        [multiple]="true" [closeOnSelect]="false" placeholder="From" appendTo="body">
                                    </ng-select>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="mr-5" for="toCity">To</label>
                                    <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let toCity of offer.travelInfo.busInfo.tos">
                                        {{ toCity.name }}
                                    </span>
                                    <ng-select *ngIf="editMode" id="toCity" name="toCity" [(ngModel)]="offer.travelInfo.busInfo.tos" [items]="cities" bindLabel="name"
                                        [multiple]="true" [closeOnSelect]="false" placeholder="To" appendTo="body">
                                    </ng-select>
                                </div>
                            </fieldset>
                        </ng-container>
                    </fieldset>
                    <div class="text-center mt-2">
                        <button type="button" class="btn btn-primary mr-3" (click)="goToTab(1)">Previous</button>
                        <button type="button" class="btn btn-success" [disabled]="detailInfoForm.form.invalid" (click)="goToNextTab(3)">Next</button>
                    </div>
                </form>
            </tab>
            <tab heading="Offer Return" (select)="onSelectTab(3)">
                <form name="offerReturnForm" role="form" #offerReturnForm="ngForm" novalidate>
                    <kendo-grid [kendoGridReactiveEditing]="createOfferReturnFormGroup" [kendoGridBinding]="offer.offerReturns" [pageable]="true"
                        [pageSize]="gridState.take" [skip]="gridState.skip" [resizable]="true" [navigable]="true" (save)="saveOfferReturn($event.dataItem)"
                        (remove)="deleteOfferReturn($event.dataItem)">
                        <ng-template kendoGridToolbarTemplate *ngIf="editMode">
                            <button class="float-right" kendoGridAddCommand>Add new</button>
                        </ng-template>
                        <kendo-grid-column class="text-center" field="id" title="ID" width="50" [editable]="false"></kendo-grid-column>
                        <kendo-grid-column class="text-center" field="extras.minimumExpense" title="Min Expense" editor="numeric"></kendo-grid-column>
                        <kendo-grid-column class="text-center" field="extras.maximumExpense" title="Max Expense" editor="numeric"></kendo-grid-column>
                        <kendo-grid-column class="text-center" field="extras.minimumReturn" title="Min Return" editor="numeric"></kendo-grid-column>
                        <kendo-grid-column class="text-center" field="extras.maximumReturn" title="Max Return" editor="numeric"></kendo-grid-column>
                        <kendo-grid-column class="text-center" field="extras.minimumTicketRequired" title="Min Ticket Required" editor="numeric"></kendo-grid-column>
                        <kendo-grid-command-column title="Action" width="180" *ngIf="editMode">
                            <ng-template kendoGridCellTemplate let-isNew="isNew">
                                <div class="text-center">
                                    <button kendoGridEditCommand class="k-primary">Edit</button>
                                    <button kendoGridRemoveCommand>Delete</button>
                                    <button kendoGridSaveCommand [disabled]="offerReturnFormGroup?.invalid">{{ isNew ? 'Add' : 'Update' }}</button>
                                    <button kendoGridCancelCommand>{{ isNew ? 'Discard' : 'Cancel' }}</button>
                                </div>
                            </ng-template>
                        </kendo-grid-command-column>
                        <ng-template kendoGridDetailTemplate let-dataItem>
                            <kendo-grid [kendoGridReactiveEditing]="createReturnInfoFormGroup" [kendoGridBinding]="dataItem.returnInfos" [pageable]="true"
                                [pageSize]="gridState.take" [skip]="gridState.skip" [resizable]="true" [navigable]="true" (save)="saveReturnInfo($event.dataItem)"
                                (remove)="deleteReturnInfo($event)">
                                <ng-template kendoGridToolbarTemplate *ngIf="editMode">
                                    <div class="float-right">
                                        <button kendoGridAddCommand>Add new</button>
                                    </div>
                                </ng-template>
                                <kendo-grid-column class="text-center" field="id" title="ID" width="50" [editable]="false"></kendo-grid-column>
                                <kendo-grid-column class="text-center" field="extras.minimumExpense" title="Min Expense" editor="numeric"></kendo-grid-column>
                                <kendo-grid-column class="text-center" field="extras.maximumExpense" title="Max Expense" editor="numeric"></kendo-grid-column>
                                <kendo-grid-column class="text-center" field="extras.minimumReturn" title="Min Return" editor="numeric"></kendo-grid-column>
                                <kendo-grid-column class="text-center" field="extras.maximumReturn" title="Max Return" editor="numeric"></kendo-grid-column>
                                <kendo-grid-column class="text-center" field="extras.minimumTicketRequired" title="Min Ticket Required" editor="numeric"></kendo-grid-column>
                                <kendo-grid-command-column title="Action" width="180" *ngIf="editMode">
                                    <ng-template kendoGridCellTemplate let-isNew="isNew">
                                        <div class="text-center">
                                            <button kendoGridEditCommand class="k-primary">Edit</button>
                                            <button kendoGridRemoveCommand>Delete</button>
                                            <button kendoGridSaveCommand [disabled]="returnInfoFormGroup?.invalid">{{ isNew ? 'Add' : 'Update' }}</button>
                                            <button kendoGridCancelCommand>{{ isNew ? 'Discard' : 'Cancel' }}</button>
                                        </div>
                                    </ng-template>
                                </kendo-grid-command-column>
                                <ng-template kendoGridDetailTemplate let-dataItem>
                                    <div class="form-group mb-3">
                                        <label class="mr-5" for="type">Return Type</label>
                                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngIf="dataItem.type && !editMode">
                                            {{ dataItem.type.name }}
                                        </span>
                                        <ng-select *ngIf="editMode" id="type" name="type" [(ngModel)]="dataItem.type" [items]="returnTypes" bindLabel="name" placeholder="Return Type"
                                            appendTo="body" required></ng-select>
                                    </div>
                                    <ng-container *ngIf="dataItem.type">
                                        <div *ngIf="dataItem.type.name === returnTypesEnum.OFFER; then offerType; else defaultType"></div>
                                        <ng-template #offerType>
                                            <fieldset class="fieldset-fix mb-3">
                                                <legend class="legend-fix">
                                                    <strong>Return Offer</strong>
                                                </legend>
                                                <div class="form-group">
                                                    <label class="mr-5" for="returnOffer">Return Offer</label>
                                                    <h5 *ngIf="dataItem.returnOffer">{{ dataItem.returnOffer.name }}</h5>
                                                    <ng-select *ngIf="editMode" id="returnOffer" name="returnOffer" [(ngModel)]="dataItem.returnOffer" [items]="offers" bindLabel="name"
                                                        placeholder="Return Offer" appendTo="body" required></ng-select>
                                                </div>
                                            </fieldset>
                                        </ng-template>
                                        <ng-template #defaultType>
                                            <fieldset class="fieldset-fix mb-3">
                                                <legend class="legend-fix">
                                                    <strong>Main Return</strong>
                                                </legend>
                                                <div class="row">
                                                    <div class="form-group col-sm-6 col-lg-4 mb-3">
                                                        <label for="amount">Amount</label>
                                                        <input type="text" apsstrNumberInput class="form-control" id="amount" name="amount
                                                          " [(ngModel)]="dataItem.mainReturn.amount" />
                                                    </div>
                                                    <div class="form-group col-sm-6 col-lg-4 mb-3">
                                                        <label for="defaultAmount">Default Amount</label>
                                                        <input type="text" apsstrNumberInput class="form-control" id="defaultAmount" name="defaultAmount" [(ngModel)]="dataItem.mainReturn.defaultAmount"
                                                        />
                                                    </div>
                                                    <div class="form-group col-sm-4 mb-3">
                                                        <span class="col-sm-6">
                                                            <label for="exact">Exact</label>
                                                        </span>
                                                        <span class="col-sm-6">
                                                            <kendo-switch id="exact" name="exact" [(ngModel)]="dataItem.mainReturn.exact" onLabel="Y" offLabel="N"></kendo-switch>
                                                        </span>
                                                    </div>
                                                    <div class="form-group col-sm-6 col-lg-4 mb-3" *ngIf="dataItem.type.name !== returnTypesEnum.RIDE">
                                                        <label for="mode">Mode</label>
                                                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngIf="dataItem.mainReturn.mode && !editMode">
                                                            {{ dataItem.mainReturn.mode.name }}
                                                        </span>
                                                        <ng-select *ngIf="editMode" id="mode" name="mode" [(ngModel)]="dataItem.mainReturn.mode" [items]="returnModes" bindLabel="name"
                                                            placeholder="Mode" appendTo="body" required></ng-select>
                                                    </div>
                                                    <div class="form-group col-sm-6 col-lg-4 mb-3" *ngIf="dataItem.type.name === returnTypesEnum.CASHBACK">
                                                        <label for="channel">Channel</label>
                                                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngIf="dataItem.mainReturn.channel && !editMode">
                                                            {{ dataItem.mainReturn.channel.name }}
                                                        </span>
                                                        <ng-select *ngIf="editMode" id="channel" name="channel" [(ngModel)]="dataItem.mainReturn.channel" [items]="cards" bindLabel="name"
                                                            placeholder="Channel" appendTo="body"></ng-select>
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </ng-template>
                                    </ng-container>
                                    <fieldset class="fieldset-fix mb-3">
                                        <legend class="legend-fix">
                                            <strong>Payment Options</strong>
                                        </legend>
                                        <div class="form-group mb-3">
                                            <label for="banks">Banks</label>
                                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let bank of dataItem.payment.banks">
                                                {{ bank.name }}
                                            </span>
                                            <ng-select *ngIf="editMode" id="banks" name="banks" [(ngModel)]="dataItem.payment.banks" [items]="banks" bindLabel="name"
                                                [multiple]="true" [closeOnSelect]="false" placeholder="Banks" appendTo="body"
                                                (change)="onBankChange($event, dataItem)">
                                                <ng-template ng-header-tmp>
                                                    <div class="my-2 ml-5">
                                                        <button (click)="selectAllBanks(dataItem)" class="btn btn-sm btn-secondary">Select all</button>
                                                        <button (click)="unselectAllBanks(dataItem)" class="btn btn-sm btn-danger">Unselect all</button>
                                                    </div>
                                                </ng-template>
                                            </ng-select>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="paymentModes">Modes</label>
                                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let paymentMode of dataItem.payment.modes">
                                                {{ paymentMode.name }}
                                            </span>
                                            <ng-select *ngIf="editMode" id="paymentModes" name="paymentModes" [(ngModel)]="dataItem.payment.modes" [items]="cardTypes"
                                                bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Payment Modes"
                                                appendTo="body" (change)="onPaymentModeChange($event, dataItem)">
                                                <ng-template ng-header-tmp>
                                                    <div class="my-2 ml-5">
                                                        <button (click)="selectAllPaymentModes(dataItem)" class="btn btn-sm btn-secondary">Select all</button>
                                                        <button (click)="unselectAllPaymentModes(dataItem)" class="btn btn-sm btn-danger">Unselect all</button>
                                                    </div>
                                                </ng-template>
                                            </ng-select>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="paymentCards">Cards</label>
                                            <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let paymentCard of dataItem.payment.cards">
                                                {{ paymentCard.name }}
                                            </span>
                                            <ng-select *ngIf="editMode" id="paymentCards" name="paymentCards" [(ngModel)]="dataItem.payment.cards" [items]="dataItem.payment.filteredCards"
                                                bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="Cards"
                                                appendTo="body"></ng-select>
                                        </div>
                                    </fieldset>
                                </ng-template>
                            </kendo-grid>
                        </ng-template>
                    </kendo-grid>
                </form>
                <div class="text-center mt-2">
                    <button type="button" class="btn btn-primary mr-3" (click)="goToTab(2)">Previous</button>
                    <button type="button" class="btn btn-success" [disabled]="offerReturnForm.form.invalid" (click)="goToNextTab(4)">Next</button>
                </div>
            </tab>
            <tab heading="Optional Info" (select)="onSelectTab(4)">
                <form name="optionalInfoForm" role="form" #optionalInfoForm="ngForm" novalidate>
                    <div class="form-group mb-3" *ngIf="editMode">
                        <label for="adminDescription">Admin Description</label>
                        <textarea autosize class="form-control" id="adminDescription" name="adminDescription" [(ngModel)]="offer.adminDescription"
                            readonly></textarea>
                    </div>
                    <div class="form-group mb-3" *ngIf="editMode || offerStates?.length > 0">
                        <label class="mr-5" for="states">States</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let state of offerStates">
                            {{ state.name }}
                        </span>
                        <ng-select *ngIf="editMode" id="states" name="states" [(ngModel)]="offerStates" [items]="states" bindLabel="name" [multiple]="true"
                            [closeOnSelect]="false" placeholder="States" appendTo="body" (change)="onStateChange($event)">
                            <ng-template ng-header-tmp>
                                <div class="my-2 ml-5">
                                    <button (click)="selectAllStates()" class="btn btn-sm btn-secondary">Select all</button>
                                    <button (click)="unselectAllStates()" class="btn btn-sm btn-danger">Unselect all</button>
                                </div>
                            </ng-template>
                        </ng-select>
                    </div>
                    <div class="form-group mb-3" *ngIf="editMode || offer?.cities?.length > 0">
                        <label class="mr-5" for="cities">Cities</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let city of offer.cities">
                            {{ city.name }}
                        </span>
                        <ng-select *ngIf="editMode" id="cities" name="cities" [(ngModel)]="offer.cities" [items]="filteredCities" bindLabel="name"
                            [multiple]="true" [closeOnSelect]="false" placeholder="Cities" appendTo="body">
                            <ng-template ng-header-tmp>
                                <div class="my-2 ml-5">
                                    <button (click)="selectAllCities()" class="btn btn-sm btn-secondary">Select all</button>
                                    <button (click)="unselectAllCities()" class="btn btn-sm btn-danger">Unselect all</button>
                                </div>
                            </ng-template>
                        </ng-select>
                    </div>
                    <div class="form-group mb-3" *ngIf="editMode || offer?.operatingSystems?.length > 0">
                        <label class="mr-5" for="operatingSystems">Operating Systems</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let operatingSystem of offer.operatingSystems">
                            {{ operatingSystem.name }}
                        </span>
                        <ng-select *ngIf="editMode" id="operatingSystems" name="operatingSystems" [(ngModel)]="offer.operatingSystems" [items]="operatingSystems"
                            bindLabel="name" [multiple]="true" [closeOnSelect]="false" placeholder="OS" appendTo="body">
                            <ng-template ng-header-tmp>
                                <div class="my-2 ml-5">
                                    <button (click)="selectAllOS()" class="btn btn-sm btn-secondary">Select all</button>
                                    <button (click)="unselectAllOS()" class="btn btn-sm btn-danger">Unselect all</button>
                                </div>
                            </ng-template>
                        </ng-select>
                    </div>
                    <div class="form-group mb-3" *ngIf="editMode || offer?.activeDates?.length > 0">
                        <label class="mr-5" for="dates">Active Dates</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let activeDate of offer.activeDates">
                            {{ activeDate.date }}
                        </span>
                        <ng-select *ngIf="editMode" id="dates" name="dates" [(ngModel)]="offer.activeDates" [items]="dates" bindLabel="date" [multiple]="true"
                            [closeOnSelect]="false" placeholder="Dates" appendTo="body"></ng-select>
                    </div>
                    <div class="form-group mb-3" *ngIf="editMode || offer?.activeDays?.length > 0">
                        <label class="mr-5" for="days">Active Days</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngFor="let activeDay of offer.activeDays">
                            {{ activeDay.day }}
                        </span>
                        <ng-select *ngIf="editMode" id="days" name="days" [(ngModel)]="offer.activeDays" [items]="days" bindLabel="day" [multiple]="true"
                            [closeOnSelect]="false" placeholder="Days" appendTo="body"></ng-select>
                    </div>
                    <div class="form-group mb-3" *ngIf="editMode || offer.policy">
                        <label class="mr-5" for="policy">Policy</label>
                        <span class="badge badge-secondary mr-2 p-2 mb-3" *ngIf="offer?.policy && !editMode">
                            {{ offer.policy.name }}
                        </span>
                        <ng-select *ngIf="editMode" id="policy" name="policy" [(ngModel)]="offer.policy" [items]="offerPolicies" bindLabel="name"
                            placeholder="Policy" appendTo="body"></ng-select>
                    </div>
                    <div class="text-center mt-2">
                        <button type="button" class="btn btn-primary mr-3" (click)="goToTab(3)">Previous</button>
                    </div>
                </form>
            </tab>
            <div class="px-5 py-3 clearfix">
                <div class="float-left">
                    <button type="button" class="btn btn-danger" (click)="goBack()">Go Back</button>
                </div>
                <div class="float-right">
                    <!-- <button type="button" class="btn btn-info" *ngIf="!editMode" (click)="editOffer()">Edit</button> -->
                    <button *ngIf="editMode" type="button" class="btn btn-success" [disabled]="isSaving || basicInfoForm.form.invalid || detailInfoForm.form.invalid || offerReturnForm.form.invalid || !tabTwoEnabled"
                        (click)="saveOffer()">Save</button>
                    <!-- <button type="button" class="btn btn-danger" *ngIf="offer?.id && editMode" (click)="cancelEdit()">Cancel</button> -->
                </div>
            </div>
        </tabset>
    </div>
</div>